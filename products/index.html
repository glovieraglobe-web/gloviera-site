<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Gloviéra Products</title>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script>
      window.__GLOVIERA_CONFIG__ = Object.assign({}, window.__GLOVIERA_CONFIG__ || {});
      window.__GLOVIERA_CONFIG__.mockPayments = true;
      window.__GLOVIERA_CONFIG__.allowMockOnFailure = true;
      window.GLOVIERA_FORCE_PAYMENT_MOCK = true;
      window.GLOVIERA_ORDER_WEBHOOK =
        'https://script.google.com/macros/s/AKfycbyahuy1wdz4eAd0cpuwdfpk794RxZlGk-8767V04Vz_x3KHpoAdEkCcVgsaPA5T3Kz8ng/exec';
    </script>
    <style>
      :root {
        color-scheme: light;
        --glo-bg: #efd88d;
        --glo-gold: #fcb100;
        --glo-amber: #b58411;
        --glo-deep: #6a0303;
        --glo-dark: #1c1a1a;
        --glo-text: #2b1f05;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Vesper Libre", "Georgia", serif;
        background: var(--glo-bg);
        color: var(--glo-text);
        overflow-x: hidden;
      }

      img {
        max-width: 100%;
        display: block;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      header {
        position: sticky;
        top: 0;
        z-index: 80;
        background: rgba(239, 216, 141, 0.95);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(252, 177, 0, 0.3);
        padding-top: calc(env(safe-area-inset-top, 0px) + 4px);
      }

      .nav-inner {
        max-width: 1100px;
        margin: 0 auto;
        padding: 20px 22px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
      }

      .logo-stack {
        display: flex;
        align-items: center;
        gap: 14px;
      }

      .logo-mark {
        width: 52px;
        height: 52px;
        background: linear-gradient(135deg, var(--glo-gold), #d89202);
        mask: url('../images/logo.png') center/contain no-repeat;
        -webkit-mask: url('../images/logo.png') center/contain no-repeat;
      }

      .brand-title {
        font-size: 22px;
        letter-spacing: 0.12em;
        color: var(--glo-deep);
        text-transform: uppercase;
        font-weight: 600;
        display: inline-block;
      }

      nav ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        gap: 24px;
        align-items: center;
        letter-spacing: 0.2em;
        font-size: 12px;
        text-transform: uppercase;
        color: var(--glo-deep);
      }

      nav .cta {
        padding: 10px 22px;
        background: var(--glo-gold);
        color: #fff;
        border-radius: 999px;
        box-shadow: 0 14px 30px rgba(252, 177, 0, 0.32);
        letter-spacing: 0.25em;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      nav a {
        display: inline-flex;
        align-items: center;
      }

      .page-footer {
        background: var(--glo-dark);
        color: #ebd1d1;
        padding: 22px 0;
        margin-top: 40px;
      }

      .page-footer .footer-inner {
        max-width: 1100px;
        margin: 0 auto;
        padding: 0 22px;
      }

      .page-footer .footer-top {
        display: grid;
        gap: 20px;
        align-items: start;
        grid-template-columns: 1fr auto;
      }

      .page-footer .footer-contacts {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .page-footer .footer-contacts a {
        display: flex;
        align-items: center;
        gap: 10px;
        color: inherit;
        text-decoration: none;
      }

      .page-footer .footer-contacts a:hover {
        color: #fff;
      }

      .page-footer .footer-map {
        justify-self: start;
      }

      .page-footer .footer-map iframe {
        width: 100%;
        max-width: 360px;
        height: 220px;
        border: 0;
        border-radius: 10px;
      }

      .page-footer .footer-map a {
        display: block;
        margin-top: 6px;
        color: inherit;
      }

      .page-footer .footer-bottom {
        margin-top: 14px;
      }

      .payment-modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: clamp(16px, 4vh, 32px) 18px;
        z-index: 9999;
        overflow-y: auto;
        padding-top: calc(env(safe-area-inset-top, 0px) + 20px);
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transition: opacity 0.28s ease, visibility 0.28s ease;
      }

      .payment-modal-overlay.show {
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
      }

      .payment-modal {
        background: rgba(255, 255, 255, 0.97);
        max-width: min(420px, 95vw);
        width: 100%;
        border-radius: 18px;
        padding: 22px 20px 24px;
        box-shadow: 0 26px 70px rgba(79, 34, 34, 0.25);
        position: relative;
        font-family: "Vesper Libre", "Georgia", serif;
        color: #4f2222;
        max-height: min(72vh, 520px);
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
        display: flex;
        flex-direction: column;
        margin: 0 auto;
        transform: translateY(16px) scale(0.96);
        opacity: 0;
        transition: transform 0.32s cubic-bezier(0.22, 0.61, 0.36, 1), opacity 0.28s ease;
      }

      .payment-modal-overlay.show .payment-modal {
        transform: translateY(0) scale(1);
        opacity: 1;
      }

      .payment-modal h3 {
        margin: 0 0 8px;
        font-size: 1.4rem;
        text-align: center;
        letter-spacing: 0.12em;
        text-transform: uppercase;
      }

      .payment-modal p.payment-subtitle {
        margin: 0 0 18px;
        text-align: center;
        font-size: 1rem;
        color: rgba(79, 34, 34, 0.75);
      }

      .payment-options {
        display: grid;
        gap: 10px;
      }

      .payment-option {
        border: 1.5px solid rgba(106, 3, 3, 0.2);
        border-radius: 14px;
        padding: 12px 14px;
        background: rgba(255, 242, 222, 0.9);
        color: inherit;
        font-weight: 600;
        text-align: left;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        gap: 6px;
        cursor: pointer;
      }

      .payment-option:hover {
        border-color: rgba(106, 3, 3, 0.55);
      }

      .payment-option.active {
        border-color: #6a0303;
        background: rgba(237, 154, 154, 0.14);
        box-shadow: 0 14px 30px rgba(106, 3, 3, 0.14);
      }

      .payment-option-title {
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .payment-option-copy {
        font-size: 0.9rem;
        font-weight: 400;
        opacity: 0.85;
      }

      .payment-form {
        margin-top: 18px;
        display: grid;
        gap: 14px;
      }

      .payment-row {
        display: grid;
        gap: 6px;
      }

      .payment-row label {
        font-size: 0.8rem;
        font-weight: 700;
        letter-spacing: 0.1em;
        color: #6a0303;
        text-transform: uppercase;
      }

      .payment-row input,
      .payment-row select,
      .payment-row textarea {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid rgba(106, 3, 3, 0.25);
        font-family: inherit;
        font-size: 0.95rem;
        background: rgba(255, 255, 255, 0.95);
      }

      .payment-summary {
        border: 1px solid rgba(106, 3, 3, 0.18);
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.88);
        padding: 14px 16px;
        display: grid;
        gap: 8px;
      }

      .payment-summary div {
        display: flex;
        justify-content: space-between;
        font-size: 0.95rem;
        font-weight: 600;
      }

      .payment-summary hr {
        border: none;
        border-top: 1px dashed rgba(106, 3, 3, 0.2);
        margin: 6px 0;
      }

      .payment-confirm {
        background: linear-gradient(135deg, var(--glo-gold), #de9603);
        border: none;
        padding: 11px 18px;
        border-radius: 999px;
        color: #fff;
        font-size: 0.96rem;
        font-weight: 700;
        letter-spacing: 0.12em;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        text-transform: uppercase;
      }

      .payment-confirm:not(:disabled):hover {
        transform: translateY(-1px);
        box-shadow: 0 16px 30px rgba(252, 177, 0, 0.35);
      }

      .payment-confirm:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
      }

      .payment-close {
        background: rgba(255, 255, 255, 0.85);
        border: none;
        font-size: 1.4rem;
        color: rgba(79, 34, 34, 0.6);
        cursor: pointer;
        align-self: flex-end;
        position: sticky;
        top: 0;
        z-index: 2;
        padding: 4px;
        margin: -4px -4px 8px;
        border-radius: 8px;
        backdrop-filter: blur(2px);
      }

      .payment-hint {
        font-size: 0.78rem;
        color: rgba(79, 34, 34, 0.7);
      }

      .payment-alert {
        color: #b10f0f;
        font-size: 0.9rem;
        min-height: 18px;
      }

      .hidden {
        display: none !important;
      }

      @media (max-width: 520px) {
        .payment-modal {
          padding: 20px 16px 22px;
        }
      }

      @media (max-width: 640px) {
        .payment-modal {
          border-radius: 16px;
          max-height: calc(100vh - env(safe-area-inset-top, 0px) - 48px);
        }
      }


      @media (max-width: 760px) {
        .nav-inner {
          padding: 14px 18px 14px;
          gap: 18px;
        }
        nav ul {
          gap: 14px;
          font-size: 11px;
          letter-spacing: 0.12em;
        }
        nav li.nav-desktop-only {
          display: none;
        }
        nav .cta {
          padding: 8px 18px;
        }
      }

      @media (max-width: 780px) {
        .page-footer .footer-top {
          grid-template-columns: 1fr;
        }
        .page-footer .footer-map {
          justify-self: stretch;
        }
        .page-footer .footer-map iframe {
          max-width: 100%;
        }
      }

      main {
        position: relative;
      }

      section {
        padding: 80px 22px;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
      }

      .hero {
        position: relative;
        padding-top: 120px;
      }

      .hero::before,
      .hero::after {
        content: "";
        position: absolute;
        border-radius: 999px;
        filter: blur(120px);
        opacity: 0.6;
      }

      .hero::before {
        top: 20%;
        left: -10%;
        width: 220px;
        height: 220px;
        background: var(--glo-gold);
      }

      .hero::after {
        bottom: -10%;
        right: -8%;
        width: 260px;
        height: 260px;
        background: var(--glo-amber);
      }

      .hero-grid {
        display: grid;
        gap: 40px;
        align-items: center;
      }

      @media (min-width: 860px) {
        .hero-grid {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      .hero h1 {
        font-size: clamp(2.6rem, 5vw, 4.6rem);
        letter-spacing: 0.04em;
        color: #073161;
        margin-bottom: 18px;
      }

      .hero p.lead {
        font-size: 1.1rem;
        line-height: 1.7;
        max-width: 520px;
        color: #4f2222;
      }

      .bullet-list {
        margin: 28px 0;
        padding: 0;
        list-style: none;
        display: grid;
        gap: 14px;
      }

      .bullet-list li {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        font-size: 1rem;
        line-height: 1.6;
      }

      .bullet-list span {
        margin-top: 7px;
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--glo-gold);
      }

      .hero-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
      }

      .btn-primary,
      .btn-outline {
        padding: 14px 28px;
        border-radius: 999px;
        text-transform: uppercase;
        letter-spacing: 0.24em;
        font-size: 12px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
      }

      .btn-primary {
        background: var(--glo-gold);
        color: #fff;
        box-shadow: 0 16px 36px rgba(252, 177, 0, 0.35);
        border: 0;
        cursor: pointer;
      }

      .btn-outline {
        border: 1px solid rgba(106, 3, 3, 0.25);
        color: var(--glo-deep);
        background: rgba(255, 255, 255, 0.6);
      }

      .hero-visual {
        display: grid;
        gap: 28px;
        justify-items: center;
      }

      .emblem-frame {
        width: 310px;
        height: 310px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.45);
        border: 1px solid rgba(255, 255, 255, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        backdrop-filter: blur(16px);
      }

      .emblem-frame::after {
        content: "";
        position: absolute;
        inset: 16px;
        border: 1px solid rgba(252, 177, 0, 0.4);
        border-radius: 50%;
      }

      .spin-logo {
        width: 228px;
        height: 228px;
        background: linear-gradient(135deg, var(--glo-gold), #de9603);
        mask: url('../images/logo.png') center/contain no-repeat;
        -webkit-mask: url('../images/logo.png') center/contain no-repeat;
        animation: spin 18s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .bottle-float {
        width: clamp(320px, 42vw, 440px);
        animation: float 8s ease-in-out infinite;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-16px);
        }
      }

      .section-title {
        text-align: center;
        text-transform: uppercase;
        letter-spacing: 0.28em;
        font-size: clamp(0.9rem, 1.25vw, 1.3rem);
        color: var(--glo-deep);
        margin-bottom: 14px;
      }

      .section-heading {
        text-align: center;
        font-size: clamp(2.2rem, 4.6vw, 3.4rem);
        color: var(--glo-deep);
        margin-bottom: 36px;
      }

      .benefits-grid {
        display: grid;
        gap: 22px;
      }

      @media (min-width: 860px) {
        .benefits-grid {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      .benefit-card {
        background: rgba(255, 255, 255, 0.75);
        padding: 28px;
        border-radius: 28px;
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 18px 45px rgba(181, 132, 17, 0.24);
        min-height: 220px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .benefit-card h3 {
        font-family: "Kanit", "Arial", sans-serif;
        letter-spacing: 0.18em;
        font-size: 18px;
        color: var(--glo-deep);
        text-transform: uppercase;
      }

      .benefit-card p {
        line-height: 1.6;
      }


      .ingredients {
        background: linear-gradient(180deg, rgba(239, 216, 141, 0.2), rgba(239, 216, 141, 0));
      }

      .ingredients-grid {
        display: grid;
        gap: 28px;
        margin-top: 40px;
      }

      .ingredient-card {
        display: grid;
        gap: 0;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 34px;
        border: 1px solid rgba(22, 15, 1, 0.15);
        box-shadow: 0 18px 48px rgba(16, 15, 1, 0.14);
        overflow: hidden;
        transition: transform 0.5s ease, box-shadow 0.5s ease;
      }

      .ingredient-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 24px 60px rgba(16, 15, 1, 0.18);
      }

      .ingredients .container,
      .spotlight .container {
        max-width: min(1800px, 92vw);
      }

      .ingredient-img {
        width: min(2475px, 70vw);
        height: min(2475px, 70vw);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        padding: 32px;
        background: linear-gradient(135deg, rgba(252, 177, 0, 0.12), rgba(239, 216, 141, 0.24));
        margin: 0 auto;
      }

      .ingredient-img img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .ingredient-card h3 {
        font-family: "Kanit", "Arial", sans-serif;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 18px;
        color: var(--glo-deep);
      }

      .ingredient-copy {
        padding: 0 28px 32px;
        line-height: 1.7;
      }

      .ritual {
        background: var(--glo-dark);
        color: white;
      }

      .ritual-grid {
        display: grid;
        gap: 32px;
        align-items: center;
      }

      @media (min-width: 860px) {
        .ritual-grid {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      .ritual-points {
        margin-top: 30px;
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
      }

      .ritual-points span {
        border: 1px solid rgba(255, 255, 255, 0.4);
        padding: 10px 18px;
        border-radius: 999px;
        letter-spacing: 0.28em;
        font-size: 11px;
        text-transform: uppercase;
      }

      .logo-panel {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 32px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        padding: 36px;
        text-align: center;
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.35);
      }

      .logo-panel .spin-logo {
        width: 70%;
        height: 70%;
        margin: 0 auto;
      }

      .testimonials {
        background: linear-gradient(180deg, rgba(247, 216, 141, 0.28), rgba(239, 216, 141, 0.4));
      }

      .testimonial-grid {
        display: grid;
        gap: 18px;
      }

      @media (min-width: 820px) {
        .testimonial-grid {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      blockquote {
        background: rgba(255, 255, 255, 0.82);
        border-radius: 28px;
        padding: 26px;
        box-shadow: 0 16px 40px rgba(111, 71, 5, 0.18);
        font-style: italic;
        line-height: 1.7;
        position: relative;
      }

      blockquote footer {
        margin-top: 16px;
        font-size: 12px;
        letter-spacing: 0.28em;
        text-transform: uppercase;
        color: var(--glo-deep);
      }

      .cta {
        background: var(--glo-dark);
        color: white;
        text-align: center;
      }

      .cta-actions {
        margin-top: 28px;
        display: flex;
        gap: 18px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .cta .btn-primary {
        color: var(--glo-dark);
        background: var(--glo-gold);
      }

      .spotlight {
        padding: 90px 22px;
        background: radial-gradient(circle at top right, rgba(252, 177, 0, 0.18), rgba(239, 216, 141, 0));
      }

      .spotlight-grid {
        display: grid;
        gap: 36px;
        align-items: center;
      }

      @media (min-width: 920px) {
        .spotlight-grid {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      .spotlight-intro {
        grid-column: 1 / -1;
        max-width: 700px;
      }

      .spotlight-values {
        display: flex;
        flex-direction: column;
        gap: 18px;
        align-items: stretch;
        justify-content: center;
      }

      .spotlight-pill {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 18px 28px;
        border-radius: 999px;
        background: var(--glo-gold);
        color: #fff;
        font-family: "Kanit", "Arial", sans-serif;
        letter-spacing: 0.28em;
        text-transform: uppercase;
        font-size: 16px;
        box-shadow: 0 20px 42px rgba(252, 177, 0, 0.35);
        min-width: 210px;
      }

      .spotlight-bottle {
        width: min(1406px, 52vw);
        max-height: min(3166px, 92vh);
        animation: float 9s ease-in-out infinite;
        object-fit: contain;
      }

      .splash {
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at top, rgba(255, 224, 150, 0.95), rgba(239, 216, 141, 0.92));
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 24px;
        z-index: 999;
        transition: opacity 0.6s ease;
      }

      .splash.hide {
        opacity: 0;
        pointer-events: none;
      }

      .scroll-cue {
        margin-top: 42px;
        text-transform: uppercase;
        letter-spacing: 0.4em;
        font-size: 11px;
        color: rgba(106, 3, 3, 0.68);
      }

      .reveal {
        opacity: 0;
        transform: translateY(60px);
        transition: opacity 0.7s ease, transform 0.7s ease;
        transition-delay: var(--reveal-delay, 0ms);
      }

      .reveal.visible {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>
  <body>
    <div class="splash" id="splash">
      <div class="logo-mark" aria-hidden="true"></div>
      <div style="text-align:center">
        <p style="letter-spacing:0.5em;text-transform:uppercase;font-size:12px;color:var(--glo-deep);margin:0">Glow Beyond Beauty</p>
        <p style="font-size:32px;margin:12px 0 0;color:var(--glo-deep);letter-spacing:0.08em;">GLOVIÉRA</p>
      </div>
      <button id="enterBtn" style="margin-top:16px;padding:12px 26px;border:0;border-radius:999px;text-transform:uppercase;letter-spacing:0.3em;font-size:11px;background:var(--glo-gold);color:#fff;box-shadow:0 16px 32px rgba(252,177,0,0.35);cursor:pointer">Enter Ritual</button>
    </div>

    <header>
      <div class="nav-inner">
        <a class="logo-stack" href="../index.html" id="homeLink">
          <div class="logo-mark" aria-hidden="true"></div>
          <span class="brand-title">Gloviéra</span>
        </a>
        <nav>
          <ul>
            <li><a href="#ritual">Ritual</a></li>
            <li><a class="cta" href="#cta">Buy Now</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <section class="hero" id="hero">
        <div class="container hero-grid reveal">
          <div>
            <h1>Gloviéra Rice Water Face Wash Ritual</h1>
            <p class="lead">
              Transform your cleanse into a golden ceremony. Silky foam, botanical actives, and a signature fragrance work together for skin that feels renewed, balanced, and luminous.
            </p>
            <ul class="bullet-list">
              <li><span></span>Rice Water revives luminosity while calming the complexion.</li>
              <li><span></span>Salicylic Acid purifies pores without compromising the skin barrier.</li>
              <li><span></span>Niacinamide smooths texture so makeup glides seamlessly.</li>
            </ul>
            <div class="hero-actions">
              <a class="btn-primary" href="#benefits">Explore Benefits</a>
              <a class="btn-outline" href="#ritual">Watch Ritual</a>
            </div>
            <div class="scroll-cue">Scroll to discover</div>
          </div>
          <div class="hero-visual">
            <div class="emblem-frame">
              <div class="spin-logo" aria-hidden="true"></div>
            </div>
            <img class="bottle-float" src="assets/bottle-black.png" alt="Gloviéra premium face wash" />
          </div>
        </div>
      </section>

      <section id="benefits">
        <div class="container">
          <span class="section-title">Why Your Skin Will Love It</span>
          <h2 class="section-heading">Crafted for Glow Seekers</h2>
          <div class="benefits-grid reveal">
            <article class="benefit-card">
              <h3>Glow beyond beauty</h3>
              <p>
                Satin-foam texture, warm floral accords, and a lit-from-within finish. Your nightly ritual becomes a sensorial escape.
              </p>
            </article>
            <article class="benefit-card">
              <h3>Clean chemistry</h3>
              <p>
                Formulated without sulphates, parabens, or harsh synthetics. Dermatologist-tested for daily devotion.
              </p>
            </article>
            <article class="benefit-card">
              <h3>Radiance that stays</h3>
              <p>
                Rice peptides and botanical humectants lock hydration for 24 hours of supple, balanced luminosity.
              </p>
            </article>
          </div>
        </div>
      </section>

      <section class="ingredients" id="ingredients">
        <div class="container">
          <span class="section-title">Star Ingredients</span>
          <h2 class="section-heading">Ancestral wisdom, modern science</h2>
          <div class="ingredients-grid">
            <article class="ingredient-card reveal" style="--reveal-delay: 0ms;">
              <div class="ingredient-img">
                <img src="assets/pure-rice-water.png" alt="Bowl of rice water" />
              </div>
              <div class="ingredient-copy">
                <h3>Pure Rice Water</h3>
                <p>
                  Infuses the skin with amino acids and minerals to brighten, soften, and calm. The centuries-old beauty secret reborn for modern glow seekers.
                </p>
              </div>
            </article>
            <article class="ingredient-card reveal" style="--reveal-delay: 120ms;">
              <div class="ingredient-img">
                <img src="assets/niacinamide.png" alt="Niacinamide serum dropper" />
              </div>
              <div class="ingredient-copy">
                <h3>Niacinamide Complex</h3>
                <p>
                  Minimises pores, balances sebum, and reinforces the barrier so your complexion stays calm, clear, and confidently luminous.
                </p>
              </div>
            </article>
            <article class="ingredient-card reveal" style="--reveal-delay: 240ms;">
              <div class="ingredient-img">
                <img src="assets/salicylic-acid.png" alt="Salicylic acid crystals" />
              </div>
              <div class="ingredient-copy">
                <h3>Salicylic Acid Elixir</h3>
                <p>
                  Micro-exfoliates within pores to dissolve congestion and prevent future flare-ups while respecting your skin’s moisture balance.
                </p>
              </div>
            </article>
          </div>
        </div>
      </section>

      <section class="spotlight" id="spotlight" style="position:relative; overflow:hidden;">
        <div class="container spotlight-grid">
          <div class="spotlight-intro reveal" style="--reveal-delay:0ms;">
            <span class="section-title">Signature Bottle</span>
            <h2 class="section-heading" style="text-align:left; max-width:620px;">A statement of luxury at your vanity</h2>
            <p style="max-width:620px; font-size:1.1rem; line-height:1.9; color:#4f2222;">
              Crafted in matte obsidian with gold embossing, the Gloviéra bottle mirrors the ritual within—elegant, refined, and made to elevate your daily glow ceremony.
            </p>
          </div>
          <div class="spotlight-values reveal" style="--reveal-delay:120ms;">
            <span class="spotlight-pill">No Sulphates</span>
            <span class="spotlight-pill">No Parabens</span>
          </div>
          <div class="reveal" style="--reveal-delay:200ms; display:flex; justify-content:center;">
            <img class="spotlight-bottle" src="assets/bottle-black.png" alt="Gloviéra premium bottle" />
          </div>
          <div class="spotlight-values reveal" style="--reveal-delay:280ms;">
            <span class="spotlight-pill">No Harsh Chemicals</span>
            <span class="spotlight-pill">Perfect for Every Skin</span>
          </div>
        </div>
      </section>

      <section class="ritual" id="ritual">
        <div class="container ritual-grid reveal" style="color:#fff;">
          <div>
            <span class="section-title" style="color:var(--glo-gold);">The Glow Ceremony</span>
            <h2 class="section-heading" style="color:var(--glo-gold);">Immerse in the ritual</h2>
            <p style="font-size:1.05rem;line-height:1.8;color:rgba(255,255,255,0.82);">
              Begin with damp skin. Emulsify two pumps of Gloviéra, breathe in the warm floral accord, massage in circular motions, and rinse to unveil a polished, illuminated complexion.
            </p>
            <div class="ritual-points">
              <span>2 pump ritual</span>
              <span>Velvet foam</span>
              <span>Instant glow</span>
            </div>
          </div>
          <div class="logo-panel">
            <div class="spin-logo" aria-hidden="true"></div>
            <p style="margin-top:22px;font-size:0.9rem;color:rgba(255,255,255,0.75);">
              The rotating sigil invites you to breathe, reset, and indulge in the Gloviéra glow.
            </p>
          </div>
        </div>
      </section>

      <section class="testimonials">
        <div class="container reveal">
          <span class="section-title">Loved by glow seekers</span>
          <h2 class="section-heading">Voices from the ritual</h2>
          <div class="testimonial-grid">
            <blockquote>
              “My pores look refined and makeup glides on flawlessly. The ritual fragrance is addictive.”
              <footer>Anika · Mumbai</footer>
            </blockquote>
            <blockquote>
              “Balanced my combination skin within a week. Luxurious yet gentle — a spa evening at home.”
              <footer>Sana · Dubai</footer>
            </blockquote>
            <blockquote>
              “Glow stays all day. No dryness, no tightness — just satin softness and confidence.”
              <footer>Maya · Singapore</footer>
            </blockquote>
          </div>
        </div>
      </section>

      <section class="cta" id="cta">
        <div class="container reveal">
          <span class="section-title" style="color:var(--glo-gold);">Unveil the glow</span>
          <h2 class="section-heading" style="color:var(--glo-gold);">Bring the ritual home</h2>
          <p style="max-width:620px;margin:0 auto;font-size:1.1rem;line-height:1.8;color:rgba(255,255,255,0.78);">
            Order Gloviéra Rice Water Face Wash and receive our ritual guide plus priority access to upcoming glow ateliers.
          </p>
          <div class="cta-actions">
            <button
              class="btn-primary"
              type="button"
              id="buyNowButton"
              data-product-name="Gloviéra Rice Water Face Wash"
              data-base-price="484"
              data-order-year="2025"
              data-order-prefix="GPF"
              data-payment-trigger="buy-now"
            >Buy Now</button>
            <a class="btn-outline" href="#hero" style="border-color:rgba(255,255,255,0.4);color:#fff;">Revisit ritual</a>
          </div>
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <div class="container footer-inner">
        <div class="footer-top">
          <div class="footer-contacts">
            <a href="https://www.instagram.com/gloviera.glam/" target="_blank" rel="noopener"><i data-feather="instagram"></i><span>Instagram</span></a>
            <a href="tel:+917009195109"><i data-feather="phone"></i><span>7009195109</span></a>
            <a href="tel:+918284932646"><i data-feather="phone"></i><span>8284932646</span></a>
            <a href="http://wa.me/917009195109" target="_blank" rel="noopener"><i data-feather="message-circle"></i><span>WhatsApp</span></a>
          </div>
          <div class="footer-map">
            <iframe loading="lazy" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps?q=30.7405139,76.6732376&z=17&output=embed" title="Gloviéra on Google Maps"></iframe>
            <a href="https://www.google.com/maps?q=30.7405139,76.6732376" target="_blank" rel="noopener">Open in Google Maps</a>
          </div>
        </div>
        <div class="footer-bottom">
          <p>© GLOVIÉRA — Glow Beyond Beauty</p>
        </div>
      </div>
    </footer>

    <script type="module">
      import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import { getFirestore, collection, addDoc, serverTimestamp, doc, runTransaction } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyC6LazuKUJqQw7JP1LHcI_z0S0MzyNg37Y",
        authDomain: "gloviera-e1c92.firebaseapp.com",
        projectId: "gloviera-e1c92",
        storageBucket: "gloviera-e1c92.firebasestorage.app",
        messagingSenderId: "980915433413",
        appId: "1:980915433413:web:dcfd8fedd54b94e73a65ac",
        measurementId: "G-FRT3966GSY"
      };

      const app = getApps().length ? getApps()[0] : initializeApp(firebaseConfig);
      const db = getFirestore(app);

      const MAX_FACEWASH_PER_ORDER = 5;
      const DELIVERY_ORDER_PREFIX = "GPF";

      const ORDER_AUTOMATION_ENDPOINT =
        (window.__GLOVIERA_CONFIG__ && window.__GLOVIERA_CONFIG__.orderAutomationWebhook) ||
        window.GLOVIERA_ORDER_WEBHOOK ||
        "";

      const API_BASE_URL =
        (window.__GLOVIERA_CONFIG__ && window.__GLOVIERA_CONFIG__.apiBaseUrl) ||
        (window.location.hostname === "localhost" ? "http://localhost:5000" : window.location.origin);

      const currencyFormatter = new Intl.NumberFormat("en-IN", {
        style: "currency",
        currency: "INR",
        maximumFractionDigits: 2
      });

      const INDIAN_STATES = [
        "Andhra Pradesh",
        "Arunachal Pradesh",
        "Assam",
        "Bihar",
        "Chhattisgarh",
        "Goa",
        "Gujarat",
        "Haryana",
        "Himachal Pradesh",
        "Jharkhand",
        "Karnataka",
        "Kerala",
        "Madhya Pradesh",
        "Maharashtra",
        "Manipur",
        "Meghalaya",
        "Mizoram",
        "Nagaland",
        "Odisha",
        "Punjab",
        "Rajasthan",
        "Sikkim",
        "Tamil Nadu",
        "Telangana",
        "Tripura",
        "Uttar Pradesh",
        "Uttarakhand",
        "West Bengal",
        "Andaman and Nicobar Islands",
        "Chandigarh",
        "Dadra and Nagar Haveli and Daman and Diu",
        "Delhi",
        "Jammu and Kashmir",
        "Ladakh",
        "Lakshadweep",
        "Puducherry"
      ];

      document.addEventListener("click", (event) => {
        const trigger = event.target.closest("[data-payment-trigger='buy-now']");
        if (!trigger) {
          return;
        }
        event.preventDefault();
        showPaymentModal(trigger);
      });

      function formatMoney(value) {
        return currencyFormatter.format(Number(value || 0));
      }

      function clampQuantity(value) {
        const parsed = Number.parseInt(value, 10);
        if (Number.isNaN(parsed) || parsed < 1) {
          return 1;
        }
        if (parsed > MAX_FACEWASH_PER_ORDER) {
          return MAX_FACEWASH_PER_ORDER;
        }
        return parsed;
      }

      async function reserveDeliveryOrderNumber({ year, prefix = DELIVERY_ORDER_PREFIX }) {
        const normalizedYear = Number.isFinite(year) && year > 0 ? Math.trunc(year) : new Date().getFullYear();
        const safePrefix = (prefix || DELIVERY_ORDER_PREFIX || "GPF").toUpperCase();
        const counterId = `${safePrefix.toLowerCase()}-${normalizedYear}`;
        const counterRef = doc(db, "orderCounters", counterId);

        try {
          const sequence = await runTransaction(db, async (transaction) => {
            const snapshot = await transaction.get(counterRef);
            const current = snapshot.exists() ? Number(snapshot.data().sequence || 0) : 0;
            const next = current + 1;

            if (snapshot.exists()) {
              transaction.update(counterRef, {
                sequence: next,
                updatedAt: serverTimestamp()
              });
            } else {
              transaction.set(counterRef, {
                sequence: next,
                year: normalizedYear,
                prefix: safePrefix,
                createdAt: serverTimestamp(),
                updatedAt: serverTimestamp()
              });
            }

            return next;
          });

          return {
            sequence,
            year: normalizedYear,
            prefix: safePrefix,
            orderNumber: `${safePrefix}-${normalizedYear}-${sequence}`
          };
        } catch (error) {
          console.warn("Unable to reserve delivery order number", error);
          throw error;
        }
      }

      async function notifyOrderAutomation(payload) {
        if (!ORDER_AUTOMATION_ENDPOINT) {
          return { skipped: true };
        }

        try {
          const response = await fetch(ORDER_AUTOMATION_ENDPOINT, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "text/plain;charset=UTF-8" },
            body: JSON.stringify(payload)
          });

          return {
            success: true,
            responseType: response && response.type ? response.type : "opaque"
          };
        } catch (error) {
          console.warn("Order automation webhook failed", error);
          return { success: false, error };
        }
      }

      function showPaymentModal(button) {
        const basePrice = Number(button.dataset.basePrice || 0);
        const productName = button.dataset.productName || "Gloviéra Ritual";
        const orderYearRaw = Number(button.dataset.orderYear);
        const orderYear =
          Number.isFinite(orderYearRaw) && orderYearRaw > 0 ? Math.trunc(orderYearRaw) : new Date().getFullYear();
        const orderPrefix = (button.dataset.orderPrefix || DELIVERY_ORDER_PREFIX || "GPF").toUpperCase();

        if (!basePrice) {
          alert("We could not determine the product price. Please try again later.");
          return;
        }

        const overlay = document.createElement("div");
        overlay.className = "payment-modal-overlay show";
        overlay.innerHTML = `
          <div class="payment-modal" role="dialog" aria-modal="true" aria-labelledby="paymentModalTitle">
            <button class="payment-close" type="button" data-close aria-label="Close payment dialog">&times;</button>
            <h3 id="paymentModalTitle">How would you like to proceed?</h3>
            <p class="payment-subtitle"><strong>GLOVIÉRA</strong> offers dual checkout tailored to your ritual.</p>
            <div class="payment-options">
              <button type="button" class="payment-option active" data-method="Salon">
                <span class="payment-option-title">Pay Now for Salon</span>
                <span class="payment-option-copy">Visit our salon experience and pay only the product price.</span>
              </button>
              <button type="button" class="payment-option" data-method="Delivery">
                <span class="payment-option-title">Pay Now for Delivery</span>
                <span class="payment-option-copy">Enjoy doorstep delivery with a transparent fee.</span>
              </button>
            </div>
            <form class="payment-form">
              <div class="payment-row">
                <label for="paymentName">Full Name</label>
                <input id="paymentName" name="customerName" type="text" placeholder="Enter your name" autocomplete="name" required />
              </div>
              <div class="payment-row">
                <label for="paymentEmail">Email</label>
                <input id="paymentEmail" name="customerEmail" type="email" placeholder="you@example.com" autocomplete="email" required />
              </div>
              <div class="payment-row">
                <label for="paymentQuantity">Quantity</label>
                <input
                  id="paymentQuantity"
                  type="number"
                  min="1"
                  max="${MAX_FACEWASH_PER_ORDER}"
                  value="1"
                  inputmode="numeric"
                  aria-describedby="paymentQuantityHint"
                />
                <small id="paymentQuantityHint" class="payment-hint">Maximum of ${MAX_FACEWASH_PER_ORDER} facewash per order.</small>
              </div>
              <div class="payment-row hidden" data-address-row>
                <label for="paymentAddress">Full Delivery Address</label>
                <textarea id="paymentAddress" rows="3" placeholder="House no., street, area" autocomplete="street-address"></textarea>
                <small class="payment-hint">Include house number, street, city, and any nearby landmark.</small>
              </div>
              <div class="payment-row hidden" data-state-row>
                <label for="paymentState">State</label>
                <select id="paymentState" data-state-select>
                  <option value="">Select your state</option>
                </select>
              </div>
              <div class="payment-row hidden" data-phone-row>
                <label for="paymentPhone">Phone Number</label>
                <input id="paymentPhone" type="text" inputmode="tel" maxlength="15" placeholder="10-digit mobile number" autocomplete="tel" />
              </div>
              <div class="payment-row hidden" data-pincode-row>
                <label for="paymentPincode">Pincode</label>
                <input id="paymentPincode" type="text" inputmode="numeric" maxlength="6" placeholder="6-digit pincode" autocomplete="postal-code" />
                <small class="payment-hint">Share the 6-digit postal code for your delivery address.</small>
              </div>
              <div class="payment-summary">
                <div><span>Unit Price</span><strong data-unit-price>${formatMoney(basePrice)}</strong></div>
                <div><span>Quantity</span><strong data-quantity-display>1</strong></div>
                <div><span>Product Subtotal</span><strong data-product-total>${formatMoney(basePrice)}</strong></div>
                <div><span>Delivery Fee</span><strong data-delivery-fee>${formatMoney(0)}</strong></div>
                <hr />
                <div><span>Total Payable</span><strong data-final-amount>${formatMoney(basePrice)}</strong></div>
              </div>
              <div class="payment-alert" data-alert></div>
              <button type="submit" class="payment-confirm" data-confirm>Proceed to Pay</button>
            </form>
          </div>
        `;
        document.body.appendChild(overlay);

        const optionButtons = Array.from(overlay.querySelectorAll(".payment-option"));
        const stateRow = overlay.querySelector("[data-state-row]");
        const stateSelect = overlay.querySelector("[data-state-select]");
        const addressRow = overlay.querySelector("[data-address-row]");
        const addressInput = overlay.querySelector("#paymentAddress");
        const phoneRow = overlay.querySelector("[data-phone-row]");
        const phoneInput = overlay.querySelector("#paymentPhone");
        const pincodeRow = overlay.querySelector("[data-pincode-row]");
        const pincodeInput = overlay.querySelector("#paymentPincode");
        const quantityInput = overlay.querySelector("#paymentQuantity");
        const quantityDisplayEl = overlay.querySelector("[data-quantity-display]");
        const productTotalEl = overlay.querySelector("[data-product-total]");
        const deliveryFeeEl = overlay.querySelector("[data-delivery-fee]");
        const finalAmountEl = overlay.querySelector("[data-final-amount]");
        const confirmBtn = overlay.querySelector("[data-confirm]");
        const alertBox = overlay.querySelector("[data-alert]");
        const closeBtn = overlay.querySelector("[data-close]");
        const nameInput = overlay.querySelector("#paymentName");
        const emailInput = overlay.querySelector("#paymentEmail");

        INDIAN_STATES.forEach((state) => {
          const option = document.createElement("option");
          option.value = state;
          option.textContent = state;
          stateSelect.appendChild(option);
        });

        let selectedMethod = "Salon";
        let deliveryFee = 0;

        function setDeliveryRequirements(isRequired) {
          stateSelect.required = isRequired;
          addressInput.required = isRequired;
          phoneInput.required = isRequired;
          pincodeInput.required = isRequired;
        }

        function updateTotals() {
          if (!quantityInput) return;

          const quantity = clampQuantity(quantityInput.value);
          if (String(quantity) !== String(quantityInput.value)) {
            quantityInput.value = quantity;
          }

          const quantityNumber = quantity || 1;

          if (selectedMethod === "Delivery") {
            const chosenState = (stateSelect.value || "").trim().toLowerCase();
            deliveryFee = chosenState === "punjab" ? 60 : 150;
            stateRow.classList.remove("hidden");
            addressRow.classList.remove("hidden");
            phoneRow.classList.remove("hidden");
            pincodeRow.classList.remove("hidden");
            setDeliveryRequirements(true);
          } else {
            deliveryFee = 0;
            stateRow.classList.add("hidden");
            addressRow.classList.add("hidden");
            phoneRow.classList.add("hidden");
            pincodeRow.classList.add("hidden");
            stateSelect.value = "";
            addressInput.value = "";
            phoneInput.value = "";
            pincodeInput.value = "";
            setDeliveryRequirements(false);
            alertBox.textContent = "";
          }

          if (quantityDisplayEl) {
            quantityDisplayEl.textContent = String(quantityNumber);
          }

          const productSubtotal = basePrice * quantityNumber;
          if (productTotalEl) {
            productTotalEl.textContent = formatMoney(productSubtotal);
          }

          deliveryFeeEl.textContent = formatMoney(deliveryFee);
          finalAmountEl.textContent = formatMoney(productSubtotal + deliveryFee);
        }

        optionButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            if (btn.dataset.method === selectedMethod) {
              return;
            }
            optionButtons.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            selectedMethod = btn.dataset.method || "Salon";
            updateTotals();
          });
        });

        stateSelect.addEventListener("change", updateTotals);
        if (quantityInput) {
          quantityInput.addEventListener("input", () => {
            alertBox.textContent = "";
            updateTotals();
          });
          quantityInput.addEventListener("change", updateTotals);
        }
        updateTotals();
        setTimeout(() => nameInput.focus(), 100);

        function closeModal() {
          overlay.classList.remove("show");
          setTimeout(() => overlay.remove(), 160);
        }

        closeBtn.addEventListener("click", closeModal);
        overlay.addEventListener("click", (event) => {
          if (event.target === overlay) {
            closeModal();
          }
        });

        overlay.querySelector("form").addEventListener("submit", async (event) => {
          event.preventDefault();
          alertBox.textContent = "";

          const name = nameInput.value.trim();
          const email = emailInput.value.trim();
          const stateValue = stateSelect.value.trim();
          const addressValue = addressInput.value.trim();
          const phoneValue = phoneInput.value.trim();
          const pincodeValue = pincodeInput.value.trim();
          const quantityRaw = quantityInput ? quantityInput.value : "1";
          const quantity = clampQuantity(quantityRaw);

          if (!name) {
            alertBox.textContent = "Please enter your name.";
            nameInput.focus();
            return;
          }

          const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!email || !emailPattern.test(email)) {
            alertBox.textContent = "Please enter a valid email.";
            emailInput.focus();
            return;
          }

          if (quantityInput) {
            if (!quantity || quantity < 1) {
              alertBox.textContent = "Select at least one product.";
              quantityInput.focus();
              quantityInput.value = "1";
              updateTotals();
              return;
            }

            const requestedQuantity = Number.parseInt(quantityRaw, 10);
            if (Number.isFinite(requestedQuantity) && requestedQuantity > MAX_FACEWASH_PER_ORDER) {
              alertBox.textContent = `You can order up to ${MAX_FACEWASH_PER_ORDER} units per order.`;
              quantityInput.value = String(MAX_FACEWASH_PER_ORDER);
              updateTotals();
              quantityInput.focus();
              return;
            }

            quantityInput.value = String(quantity);
            updateTotals();
          }

          if (selectedMethod === "Delivery" && !stateValue) {
            alertBox.textContent = "Choose your state for delivery calculations.";
            stateSelect.focus();
            return;
          }

          if (selectedMethod === "Delivery" && addressValue.length < 8) {
            alertBox.textContent = "Enter your full delivery address.";
            addressInput.focus();
            return;
          }

          if (selectedMethod === "Delivery") {
            const phonePattern = /^\d{10}$/;
            if (!phonePattern.test(phoneValue)) {
              alertBox.textContent = "Enter a valid 10-digit phone number.";
              phoneInput.focus();
              return;
            }
            const pincodePattern = /^\d{6}$/;
            if (!pincodePattern.test(pincodeValue)) {
              alertBox.textContent = "Enter a valid 6-digit pincode.";
              pincodeInput.focus();
              return;
            }
          }

          const productSubtotal = basePrice * (quantity || 1);
          const finalPrice = productSubtotal + deliveryFee;

          const deliveryDetails =
            selectedMethod === "Delivery"
              ? {
                  state: stateValue,
                  address: addressValue,
                  pincode: pincodeValue,
                  phone: phoneValue
                }
              : {
                  state: "N/A",
                  address: "N/A",
                  pincode: "N/A",
                  phone: ""
                };

          let orderNumberInfo = null;
          if (selectedMethod === "Delivery") {
            try {
              orderNumberInfo = await reserveDeliveryOrderNumber({ year: orderYear, prefix: orderPrefix });
            } catch (counterError) {
              console.warn("Order number reservation failed", counterError);
              alertBox.textContent =
                "We couldn't generate an order number right now. Please try again in a moment.";
              return;
            }
          }

          confirmBtn.disabled = true;
          confirmBtn.textContent = "Redirecting…";

          const config = window.__GLOVIERA_CONFIG__ || {};
          const shouldMockPayments = Boolean(config.mockPayments || window.GLOVIERA_FORCE_PAYMENT_MOCK);
          const allowMockOnFailure = config.allowMockOnFailure !== false;

          try {
            let data;
            let usedMock = false;

            if (!shouldMockPayments) {
              try {
                const response = await fetch(`${API_BASE_URL}/api/payments/create`, {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({
                    amount: finalPrice,
                    currency: "INR",
                    metadata: {
                      productName,
                      unitPrice: basePrice,
                      quantity,
                      productSubtotal,
                      deliveryFee,
                      finalPrice,
                      paymentMethod: selectedMethod,
                      orderYear,
                      orderPrefix,
                      orderNumber: orderNumberInfo?.orderNumber || null,
                      maxQuantityPerOrder: MAX_FACEWASH_PER_ORDER,
                      ...deliveryDetails
                    },
                    customer: {
                      name,
                      email,
                      phone: deliveryDetails.phone
                    }
                  })
                });

                data = await response.json();
                if (!response.ok) {
                  throw new Error(data?.message || "Unable to start the payment. Please try again.");
                }
              } catch (networkError) {
                if (!allowMockOnFailure) {
                  throw networkError;
                }
                console.warn("PhonePe create payment failed, using mock flow instead.", networkError);
                usedMock = true;
              }
            } else {
              usedMock = true;
            }

            if (usedMock) {
              data = {
                merchantTransactionId: `mock_${Date.now()}`,
                redirectUrl: "",
                mock: true
              };
            }

            const orderId = data?.merchantTransactionId || `ord_${Date.now()}`;

            const orderRecord = {
              orderId,
              orderNumber: orderNumberInfo?.orderNumber || null,
              orderSequence: orderNumberInfo?.sequence ?? null,
              orderYear,
              orderPrefix,
              name,
              email,
              product: productName,
              unitPrice: basePrice,
              quantity,
              productSubtotal,
              deliveryFee,
              finalPrice,
              paymentMethod: selectedMethod,
              state: deliveryDetails.state,
              address: deliveryDetails.address,
              pincode: deliveryDetails.pincode,
              phone: deliveryDetails.phone,
              status: "Payment Pending",
              reviewStatus: selectedMethod === "Salon" ? "Pending" : "N/A",
              maxQuantityPerOrder: MAX_FACEWASH_PER_ORDER,
              automationWebhookConfigured: Boolean(ORDER_AUTOMATION_ENDPOINT),
              paymentMock: usedMock,
              createdAt: serverTimestamp()
            };

            try {
              await addDoc(collection(db, "productOrders"), orderRecord);
            } catch (firestoreError) {
              console.warn("Unable to store order in Firestore", firestoreError);
            }

            const automationPayload = {
              event: "product_order_initiated",
              orderId,
              orderNumber: orderNumberInfo?.orderNumber || "",
              orderSequence: orderNumberInfo?.sequence ?? null,
              orderYear,
              orderPrefix,
              paymentMethod: selectedMethod,
              status: "Payment Pending",
              productName,
              quantity,
              unitPrice: basePrice,
              productSubtotal,
              deliveryFee,
              finalPrice,
              maxQuantityPerOrder: MAX_FACEWASH_PER_ORDER,
              mockPayment: usedMock,
              customer: {
                name,
                email,
                phone: deliveryDetails.phone || "",
                state: deliveryDetails.state,
                address: deliveryDetails.address,
                pincode: deliveryDetails.pincode
              },
              reviewRequested: selectedMethod === "Salon",
              emailTemplate: selectedMethod === "Salon" ? "salon_thank_you" : "delivery_in_transit",
              paymentUrl: data?.redirectUrl || "",
              timestamp: new Date().toISOString()
            };

            await notifyOrderAutomation(automationPayload);

            closeModal();

            if (data?.redirectUrl && !usedMock) {
              window.location.href = data.redirectUrl;
              return;
            }

            if (usedMock) {
              alert("Your order has been recorded. Expect a confirmation email shortly.");
            } else {
              alert("Payment initiated. Follow the gateway instructions to complete your order.");
            }
          } catch (error) {
            console.error(error);
            alertBox.textContent = error.message || "Failed to start the payment. Please try again.";
            confirmBtn.disabled = false;
            confirmBtn.textContent = "Proceed to Pay";
          }
        });
      }
    </script>
    <script>
      const splash = document.getElementById('splash');
      const enterBtn = document.getElementById('enterBtn');
      const yearSpan = document.getElementById('year');
      if (yearSpan) yearSpan.textContent = new Date().getFullYear();

      function hideSplash() {
        if (!splash) return;
        splash.classList.add('hide');
        setTimeout(() => {
          splash.style.display = 'none';
        }, 650);
      }

      enterBtn.addEventListener('click', hideSplash);
      setTimeout(hideSplash, 2200);

      const homeTargets = [document.getElementById('homeLink'), ...document.querySelectorAll('.nav-home')];
      homeTargets.forEach((link) => {
        if (!link) return;
        link.addEventListener('click', (event) => {
          event.preventDefault();
          if (!splash) {
            window.location.href = link.getAttribute('href');
            return;
          }
          splash.style.display = 'flex';
          splash.classList.remove('hide');
          requestAnimationFrame(() => {
            splash.style.opacity = '1';
          });
          setTimeout(() => {
            window.location.href = link.getAttribute('href');
          }, 600);
        });
      });

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        },
        { threshold: 0.25 }
      );

      document.querySelectorAll('.reveal').forEach((el) => observer.observe(el));
    </script>
    <script>
      try { feather && feather.replace && feather.replace(); } catch (e) {}
    </script>
  </body>
  </html>
